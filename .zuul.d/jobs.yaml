- job:
    name: networking-odl-config-job
    description: Fake job to hold configuration settings for jobs
    vars:
      python_version: '3.6'
      odl_version_map:
        oxygen: &oxygen oxygen-latest
        fluorine: &fluorine fluorine-snapshot-0.9
        neon: &neon neon-latest
        sodium: &sodium sodium-latest
      common_devstack_vars: &devstack_vars
        devstack_localrc:
          ODL_TIMEOUT: 60
          ODL_RELEASE: latest-snapshot
          # Set here which ODL openstack service provider to use
          ODL_NETVIRT_KARAF_FEATURE: odl-neutron-service,odl-restconf-all,odl-aaa-authn,odl-dlux-core,odl-mdsal-apidocs,odl-netvirt-openstack,odl-neutron-logger,odl-neutron-hostconfig-ovs
          # Switch to using the ODL's L3 implementation
          ODL_L3: True
          # public network connectivity
          ODL_PROVIDER_MAPPINGS: public:br-ex
          PUBLIC_PHYSICAL_NETWORK: public
          PUBLIC_BRIDGE: br-ex
          Q_USE_PUBLIC_VETH: False
          Q_ML2_PLUGIN_MECHANISM_DRIVERS: logger,opendaylight_v2
          # Enable debug logs for odl ovsdb
          ODL_NETVIRT_DEBUG_LOGS: True
          # Database
          MYSQL_PASSWORD: secretmysql
          DATABASE_QUERY_LOGGING: True
          OS_LOG_PATH: '{{ zuul.executor.log_root }}'
          IS_GATE: True
        devstack_services: &devstack_services
          c-api: True
          c-bak: True
          c-sch: True
          c-vol: True
          cinder: True
          dstat: True
          g-api: True
          g-reg: True
          horizon: False
          key: True
          mysql: True
          n-api-meta: True
          n-api: True
          n-cauth: False
          n-cond: True
          n-cpu: True
          n-crt: True
          n-novnc: False
          n-obj: True
          n-sch: True
          neutron: True
          placement-api: True
          placement-client: False
          q-agt: False
          q-dhcp: True
          q-l3: False
          q-meta: True
          q-svc: True
          q-qos: True
          rabbit: True
        devstack_plugins: &devstack_plugins
          networking-odl: https://opendev.org/openstack/networking-odl

- job:
    name: networking-odl-rally-neon
    parent: rally-task-at-devstack
    nodeset: openstack-single-node-focal
    vars:
      devstack_localrc:
        ODL_RELEASE: *neon
      devstack_plugins:
        rally-openstack: https://opendev.org/openstack/rally-openstack
        networking-odl: https://opendev.org/openstack/networking-odl
      rally_task: rally-jobs/odl.yaml
    timeout: 7500
    required-projects:
      - name: openstack/devstack
        override-checkout: stable/xena
      - name: openstack/networking-odl
        override-checkout: stable/xena
      - name: openstack/rally
        override-checkout: stable/xena
      - name: openstack/rally-openstack
        override-checkout: stable/xena
    irrelevant-files:
      - ^.*\.rst$
      - ^doc/.*$
      - ^neutron/locale/.*$
      - ^neutron/tests/unit/.*$
      - ^releasenotes/.*$
      - ^tools/.*$
      - ^tox.ini$

- job:
    name: networking-odl-rally-sodium
    parent: rally-task-at-devstack
    nodeset: openstack-single-node-focal
    vars:
      devstack_localrc:
        ODL_RELEASE: *sodium
      devstack_plugins:
        rally-openstack: https://opendev.org/openstack/rally-openstack
        networking-odl: https://opendev.org/openstack/networking-odl
      rally_task: rally-jobs/odl.yaml
    timeout: 7500
    required-projects:
      - name: openstack/devstack
        override-checkout: stable/xena
      - name: openstack/networking-odl
        override-checkout: stable/xena
      - name: openstack/rally
        override-checkout: stable/xena
      - name: openstack/rally-openstack
        override-checkout: stable/xena
    irrelevant-files:
      - ^.*\.rst$
      - ^doc/.*$
      - ^neutron/locale/.*$
      - ^neutron/tests/unit/.*$
      - ^releasenotes/.*$
      - ^tools/.*$
      - ^tox.ini$

